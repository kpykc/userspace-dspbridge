<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
<HEAD>
<TITLE>ti.sdo.fc.dman3DMAN3 SOURCE BODY </TITLE>
<LINK rel=stylesheet type=text/css href=../../../../styles.css>
</HEAD>
<BODY onLoad="top.frames.hdr.location.replace('DMAN3-srcHdr.html')">
<PRE class=Src>
     1    <font color=darkred>/* 
</font>     2    <font color=darkred> *  Copyright 2007
</font>     3    <font color=darkred> *  Texas Instruments Incorporated
</font>     4    <font color=darkred> *
</font>     5    <font color=darkred> *  All rights reserved.  Property of Texas Instruments Incorporated
</font>     6    <font color=darkred> *  Restricted rights to use, duplicate or disclose this code are
</font>     7    <font color=darkred> *  granted through contract.
</font>     8    <font color=darkred> * 
</font>     9    <font color=darkred> */</font>
    10    <font color=teal>/*!
</font>    11    <font color=teal> *  ======== DMAN3 ========
</font>    12    <font color=teal> *  Joule DMA Manager.
</font>    13    <font color=teal> */</font>
    14    @Template(<font color=#553300>"./DMAN3.xdt"</font>)
    15    
    16    <b><font color="#3333CC">metaonly</font></b> <b><font color="#3333CC">module</font></b> DMAN3 {
    17    
    18        <font color=darkred>/* These const values must match those in dman3.h */</font>
    19        <b><font color="#3333CC">const</font></b> Int MAXDMARECS = 32;  <font color=teal>/*! Maximum number of DMA handles allowed
</font>    20    <font color=teal>                                  for a XDAIS algorithm. */</font>
    21    
    22        <b><font color="#3333CC">const</font></b> Int MAXGROUPS = 20;  <font color=teal>/*! Maximum number of groups for sharing
</font>    23    <font color=teal>                                 TCCs and parameter RAM. */</font>
    24    
    25        <font color=teal>/*!
</font>    26    <font color=teal>     *  ======== qdmaPaRamBase ========
</font>    27    <font color=teal>     *  Physical base address of the PARAM0 in the EDMA3/QDMA
</font>    28    <font color=teal>     *  hardware whose resources are being managed by DMAN3.
</font>    29    <font color=teal>     */</font>
    30        <b><font color="#3333CC">config</font></b> Ptr  qdmaPaRamBase =  0x01C04000 ;  <font color=teal>/*! This parameter is set to
</font>    31    <font color=teal>                                                *  DMAN3_QDMA_PARAM_BASE
</font>    32    <font color=teal>                                                */</font>
    33    
    34        <font color=teal>/*!
</font>    35    <font color=teal>     *  ======== maxPaRamEntries ========
</font>    36    <font color=teal>     *  Total number of PARAM Table entries on the target hardware.
</font>    37    <font color=teal>     *  (eg, for IVA2, Davinci this is 128, for Himalaya, this is 256).
</font>    38    <font color=teal>     */</font>
    39        <b><font color="#3333CC">config</font></b> UInt maxPaRamEntries = 128;  <font color=teal>/*! This parameter is set to
</font>    40    <font color=teal>                                         *  DMAN3_MAX_PARAM_ENTRIES 
</font>    41    <font color=teal>                                         */</font>
    42    
    43        <font color=teal>/*!
</font>    44    <font color=teal>     *  ======== paRamBaseIndex ========
</font>    45    <font color=teal>     *  (0 &gt; value &gt; 255) represents the first PARAM TABLE ENTRY
</font>    46    <font color=teal>     *  NUMBER that is assigned by configuration for exclusive DMAN3 allocation.
</font>    47    <font color=teal>     *  Typically, addresses (PaRam sets) between 0 and 63 are reserved for use 
</font>    48    <font color=teal>     *  by drivers that need EDMA/chaining capabilities. Additionally, on
</font>    49    <font color=teal>     *  DM6446 PaRams are shared between the Arm and the DSP, and DMAN3 should
</font>    50    <font color=teal>     *  be configured to avoid using what the Arm uses. On 2430, the Arm
</font>    51    <font color=teal>     *  doesn't have access to EDMA so PaRam sets below 64 are OK -- they won't 
</font>    52    <font color=teal>     *  conflict with the Arm.
</font>    53    <font color=teal>     */</font>
    54        <b><font color="#3333CC">config</font></b> UInt paRamBaseIndex =  96;  <font color=teal>/*! This parameter is set to
</font>    55    <font color=teal>                                        *  DMAN3_PARAM_BASE_INDEX
</font>    56    <font color=teal>                                        */</font>
    57    
    58        <font color=teal>/*!
</font>    59    <font color=teal>     *  ======== numPaRamEntries ========
</font>    60    <font color=teal>     *  Number of PARAM Table entries starting at DMAN3_PARAM_BASE_INDEX
</font>    61    <font color=teal>     *  assigned by configuration for exclusive DMAN3 allocation.
</font>    62    <font color=teal>     */</font>
    63        <b><font color="#3333CC">config</font></b> UInt numPaRamEntries = 32;  <font color=teal>/*! This parameter is set to
</font>    64    <font color=teal>                                        *  DMAN3_NUM_CONTIGUOUS_PARAM_ENTRIES
</font>    65    <font color=teal>                                        */</font>
    66    
    67        <font color=teal>/*!
</font>    68    <font color=teal>     *  ======== maxQdmaChannels ========
</font>    69    <font color=teal>     *  The total number of Physical QDMA channels available on the 
</font>    70    <font color=teal>     *  target hardware (eg, 8 for DaVinci, 4 for IVA2).
</font>    71    <font color=teal>     */</font>
    72        <b><font color="#3333CC">config</font></b> UInt maxQdmaChannels = 8;  <font color=teal>/*! This parameter is set to
</font>    73    <font color=teal>                                       *  DMAN3_MAX_QDMA_CHANNELS
</font>    74    <font color=teal>                                       */</font>
    75    
    76        <font color=teal>/*!
</font>    77    <font color=teal>     *  ======== numQdmaChannels ========
</font>    78    <font color=teal>     *  The number of Physical QDMA channels that are assigned to
</font>    79    <font color=teal>     *  DMAN3 via configuration.
</font>    80    <font color=teal>     */</font>
    81        <b><font color="#3333CC">config</font></b> UInt numQdmaChannels = 4;  <font color=teal>/*! This parameter is set to
</font>    82    <font color=teal>                                       *  DMAN3_NUM_QDMA_CHANNELS
</font>    83    <font color=teal>                                       */</font>
    84    
    85        <font color=teal>/*!
</font>    86    <font color=teal>     *  ======== qdmaChannels ========
</font>    87    <font color=teal>     *  Array containing list of DMAN3_NUM_QDMA_CHANNELS
</font>    88    <font color=teal>     *  many Physical QDMA channels assigned to DMAN3 via configuration.
</font>    89    <font color=teal>     */</font>
    90        <b><font color="#3333CC">config</font></b> UInt qdmaChannels[<b><font color="#3333CC">length</font></b>] = [0,1,2,3];  <font color=teal>/*! This parameter is set to
</font>    91    <font color=teal>                                                    *  DMAN3_QDMA_CHANNELS[]
</font>    92    <font color=teal>                                                    */</font>
    93    
    94        <font color=teal>/*!
</font>    95    <font color=teal>     *  ======== tccAllocationMaskH ========
</font>    96    <font color=teal>     *  32-bit bitmask representing configuration provided list of TCCs
</font>    97    <font color=teal>     *  for exclusive DMAN3 allocation.
</font>    98    <font color=teal>     *
</font>    99    <font color=teal>     *  For example, for TCC's in the range 0-31 the Low Mask
</font>   100    <font color=teal>     *  (tccAllocationMaskL) is configured so that a '1' in bit position 'i'
</font>   101    <font color=teal>     *  indicates the TCC 'i' is assigned to DMAN3.
</font>   102    <font color=teal>     */</font>
   103        <b><font color="#3333CC">config</font></b> UInt tccAllocationMaskH = 0xffffffff; <font color=teal>/*! This parameter is set to
</font>   104    <font color=teal>                                                  *  DMAN3_TCC_FREEMASK_H
</font>   105    <font color=teal>                                                  */</font>
   106    
   107        <font color=teal>/*!
</font>   108    <font color=teal>     *  ======== tccAllocationMaskL ========
</font>   109    <font color=teal>     *  32-bit bitmask representing configuration provided list of TCCs
</font>   110    <font color=teal>     *  for exclusive DMAN3 allocation.
</font>   111    <font color=teal>     *
</font>   112    <font color=teal>     *  For example, for TCC's in the range 0-31 the Low Mask
</font>   113    <font color=teal>     *  (tccAllocationMaskL) is configured so that a '1' in bit position 'i'
</font>   114    <font color=teal>     *  indicates the TCC 'i' is assigned to DMAN3.
</font>   115    <font color=teal>     */</font>
   116        <b><font color="#3333CC">config</font></b> UInt tccAllocationMaskL = 0x00000000;<font color=teal>/*! This parameter is set to
</font>   117    <font color=teal>                                                 *  DMAN3_TCC_FREEMASK_L
</font>   118    <font color=teal>                                                 */</font>
   119    
   120        <font color=darkred>/*
</font>   121    <font color=darkred>     * TODO:  These "Strings" should be Ints... how do we get a handle to
</font>   122    <font color=darkred>     * the BIOS objects in javascript-land?
</font>   123    <font color=darkred>     */</font>
   124    
   125        <font color=teal>/*!
</font>   126    <font color=teal>     *  ======== heapInternal ========
</font>   127    <font color=teal>     *  BIOS Heap ID for dynamic allocation of DMAN3 objects.
</font>   128    <font color=teal>     *
</font>   129    <font color=teal>     *  This must be allocated in L1D Internal RAM.
</font>   130    <font color=teal>     */</font>
   131        <b><font color="#3333CC">config</font></b> String heapInternal = <font color=#553300>"DMAN3_heapInternal_undefined"</font>; <font color=teal>/*! This parameter is set to
</font>   132    <font color=teal>                                                                  *  DMAN3_HEAP_INTERNAL
</font>   133    <font color=teal>                                                                  */</font>
   134        <font color=teal>/*!
</font>   135    <font color=teal>     *  ======== heapExternal ========
</font>   136    <font color=teal>     *  BIOS Heap ID for dyn allocation of private DMAN3 data structures.
</font>   137    <font color=teal>     */</font>
   138        <b><font color="#3333CC">config</font></b> String heapExternal = <font color=#553300>"DMAN3_heapExternal_undefined"</font>;  <font color=teal>/*! This parameter is set to
</font>   139    <font color=teal>                                                                   *  DMAN3_HEAP_EXTERNAL */</font>
   140    
   141        <font color=teal>/*!
</font>   142    <font color=teal>     *  ======== numTccGroup ========
</font>   143    <font color=teal>     *  Addresses of arrays containing the number of TCC that will be
</font>   144    <font color=teal>     *  assigned to groups for sharing.
</font>   145    <font color=teal>     *
</font>   146    <font color=teal>     *  Channels created with a given group ID will use TCCs and PaRams
</font>   147    <font color=teal>     *  allocated for that group ID, and may share them with other channels
</font>   148    <font color=teal>     *  created with the same group ID.
</font>   149    <font color=teal>     */</font>
   150        <b><font color="#3333CC">config</font></b> Int numTccGroup[MAXGROUPS] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0,
   151                0, 0, 0, 0, 0, 0, 0,];    <font color=teal>/*! This parameter is set to
</font>   152    <font color=teal>                                       *  DMAN3_NUMTCC_GROUP
</font>   153    <font color=teal>                                       */</font>
   154    
   155        <font color=teal>/*!
</font>   156    <font color=teal>     *  ======== numPaRamGroup ========
</font>   157    <font color=teal>     *  Addresses of arrays containing the PaRam entries that will be
</font>   158    <font color=teal>     *  assigned to groups for sharing.
</font>   159    <font color=teal>     *
</font>   160    <font color=teal>     *  Channels created with a given group ID will use TCCs and PaRams
</font>   161    <font color=teal>     *  allocated for that group ID, and may share them with other channels
</font>   162    <font color=teal>     *  created with the same group ID.
</font>   163    <font color=teal>     */</font>
   164        <b><font color="#3333CC">config</font></b> Int numPaRamGroup[MAXGROUPS]= [0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0,
   165                0, 0, 0, 0, 0, 0, 0,] ;  <font color=teal>/*! This parameter is set to
</font>   166    <font color=teal>                                      *  DMAN3_NUMPARAM_GROUP
</font>   167    <font color=teal>                                      */</font>
   168    
   169        <font color=teal>/*!
</font>   170    <font color=teal>     *  ======== scratchAllocFxn ========
</font>   171    <font color=teal>     *  Function for allocating IDMA3 channel object's "env" in scratch
</font>   172    <font color=teal>     *  memory.
</font>   173    <font color=teal>     */</font>
   174        <b><font color="#3333CC">config</font></b> String scratchAllocFxn = <b><font color="#3333CC">null</font></b>;
   175    
   176        <font color=teal>/*!
</font>   177    <font color=teal>     *  ======== scratchFreeFxn ========
</font>   178    <font color=teal>     *  Function for freeing IDMA3 channel object's "env" that was allocated
</font>   179    <font color=teal>     *  in scratch memory.
</font>   180    <font color=teal>     */</font>
   181        <b><font color="#3333CC">config</font></b> String scratchFreeFxn = <b><font color="#3333CC">null</font></b>;
   182    
   183        <font color=teal>/*!
</font>   184    <font color=teal>     *  ======== nullPaRamIndex ========
</font>   185    <font color=teal>     *  Index of PARAM to be reserved as a "null" PaRam. This index will be
</font>   186    <font color=teal>     *  used to set QCHMAP when the corresponding QDMA channel is not active.
</font>   187    <font color=teal>     */</font>
   188        <b><font color="#3333CC">config</font></b> UInt nullPaRamIndex = 0;    <font color=teal>/*! This parameter is set to
</font>   189    <font color=teal>                                        *  DMAN3_NULLPARAMINDEX
</font>   190    <font color=teal>                                        */</font>
   191    
   192        <font color=teal>/*!
</font>   193    <font color=teal>     *  ======== idma3Internal ========
</font>   194    <font color=teal>     *  Use the internal memory heap for dynamic allocation of IDMA3 objects.
</font>   195    <font color=teal>     *
</font>   196    <font color=teal>     *  A value of 'false' means that IDMA3 objects will be allocated in the heap
</font>   197    <font color=teal>     *  specified by DMAN3_PARAMS.heapExternal. If the value of idma3Internal
</font>   198    <font color=teal>     *  is 'true', IDMA3 objects will be allocated in the heap specified
</font>   199    <font color=teal>     *  by DMAN3_PARAMS.heapInternal.
</font>   200    <font color=teal>     */</font>
   201        <b><font color="#3333CC">config</font></b> <b><font color="#3333CC">bool</font></b> idma3Internal = <b><font color="#3333CC">true</font></b>;
   202    
   203        <font color=teal>/*!
</font>   204    <font color=teal>     *  ======== debug ========
</font>   205    <font color=teal>     *  Enable the debug profile of the DMAN3 library.
</font>   206    <font color=teal>     *
</font>   207    <font color=teal>     *  This will likely result in a larger and slower library being linked in,
</font>   208    <font color=teal>     *  but it will provide extra parameter checking and debug trace
</font>   209    <font color=teal>     *  statements dropped in the BIOS SYS trace buffer.
</font>   210    <font color=teal>     */</font>
   211        <b><font color="#3333CC">config</font></b> <b><font color="#3333CC">bool</font></b> debug = <b><font color="#3333CC">false</font></b>;
   212    }
   213    
   214    <font color=darkred>/*
</font>   215    <font color=darkred> *  @(#) ti.sdo.fc.dman3; 1, 0, 1,66; 5-10-2007 10:49:45; /db/atree/library/trees/fc-b12x/src/
</font>   216    <font color=darkred> */</font>
   217    
</PRE>
</BODY>
</HTML>
