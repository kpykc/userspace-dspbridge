\hypertarget{group___d_s_p_d_s_k_t2}{
\subsection{DSKT2}
\label{group___d_s_p_d_s_k_t2}\index{DSKT2@{DSKT2}}
}


\subsubsection{Detailed Description}
The XDAIS Socket Library provides services to support the creation, initialization, control, and deletion of XDAIS algorithm instance objects. 

\subsubsection*{Defines}
\begin{CompactItemize}
\item 
\#define \hyperlink{group___d_s_p_d_s_k_t2_g6ea3f0bc0c9a697930cf7d8411975ac2}{DSKT2\_\-NUM\_\-SCRATCH\_\-GROUPS}~20
\item 
\#define \hyperlink{group___d_s_p_d_s_k_t2_gb7906673f1c60a08206bd37c7f7d1178}{DSKT2\_\-MAX\_\-MEM\_\-ALLOCATION\_\-SIZE}~0x\-FFFF
\item 
\#define \hyperlink{group___d_s_p_d_s_k_t2_gcb5e98129cb03f61436195c9fd240804}{DSKT2\_\-NUM\_\-SHAREDHEAPS}~2
\end{CompactItemize}
\subsubsection*{Typedefs}
\begin{CompactItemize}
\item 
typedef Void($\ast$) \hyperlink{group___d_s_p_d_s_k_t2_gc2be66a39e491bc30ef6f01d7a0a4361}{DSKT2\_\-Cache\-WBInv\-Fxn} (Ptr block\-Ptr, size\_\-t byte\-Cnt, Bool wait)
\begin{CompactList}\small\item\em Function prototype of cache writeback function: Writes back the memory within the range of block\-Ptr and block\-Ptr + byte\-Cnt. \item\end{CompactList}\end{CompactItemize}
\subsubsection*{Functions}
\begin{CompactItemize}
\item 
Void \hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg} (Int scratch\-Mutex\-Id, \hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} alg)
\begin{CompactList}\small\item\em Prepares a x\-DAIS algorithm instance object to start using its scratch memory. \item\end{CompactList}\item 
Int \hyperlink{group___d_s_p_d_s_k_t2_g65d8c7ae9d40adcda0c92a9e51c6fd0b}{DSKT2\_\-control\-Alg} (\hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} alg, \hyperlink{group__ti__xdais___i_a_l_g_g9032f20923ef2ba1d6b88c87a20075fa}{IALG\_\-Cmd} cmd, \hyperlink{struct_i_a_l_g___status}{IALG\_\-Status} $\ast$status)
\begin{CompactList}\small\item\em This is a convenience API to call a x\-DAIS algorithm instance's alg\-Control function. \item\end{CompactList}\item 
\hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} \hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg} (Int scratch\-Mutex\-Id, \hyperlink{struct_i_a_l_g___fxns}{IALG\_\-Fxns} $\ast$fxns, \hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} parent, \hyperlink{struct_i_a_l_g___params}{IALG\_\-Params} $\ast$params)
\begin{CompactList}\small\item\em Creates and initializes a x\-DAIS algorithm instance object. \item\end{CompactList}\item 
\hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} \hyperlink{group___d_s_p_d_s_k_t2_gda6c7f86ed679447cb8f69b0c50a616c}{DSKT2\_\-create\-Alg2} (Int scratch\-Mutex\-Id, \hyperlink{struct_i_a_l_g___fxns}{IALG\_\-Fxns} $\ast$fxns, \hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} parent, \hyperlink{struct_i_a_l_g___params}{IALG\_\-Params} $\ast$params, Int ext\-Heap\-Id)
\begin{CompactList}\small\item\em Creates and initializes a x\-DAIS algorithm instance object. \item\end{CompactList}\item 
Void \hyperlink{group___d_s_p_d_s_k_t2_g74b6b6feca63328906acade37d23b597}{DSKT2\_\-deactivate\-Alg} (Int scratch\-Mutex\-Id, \hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} alg)
\begin{CompactList}\small\item\em Prepares a x\-DAIS algorithm instance object to give up using its scratch memory. \item\end{CompactList}\item 
Int \hyperlink{group___d_s_p_d_s_k_t2_g2d252c736a3bb828d9f646cc379ac0e2}{DSKT2\_\-deactivate\-All} ()
\begin{CompactList}\small\item\em All algorithms that have been deactivated lazily are now really deactivate. Any algorithms that are still currently active will be left as is. The number of algorithms that are still active will be returned from this call. \item\end{CompactList}\item 
Bool \hyperlink{group___d_s_p_d_s_k_t2_g8dffa02b3ca1ff6856ce3cf610be7435}{DSKT2\_\-free\-Alg} (Int scratch\-Mutex\-Id, \hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} alg)
\begin{CompactList}\small\item\em Deletes a x\-DAIS algorithm instance object and frees all persistent memory allocated for the instance object. \item\end{CompactList}\end{CompactItemize}


\subsubsection{Define Documentation}
\hypertarget{group___d_s_p_d_s_k_t2_g6ea3f0bc0c9a697930cf7d8411975ac2}{
\index{DSPDSKT2@{DSPDSKT2}!DSKT2_NUM_SCRATCH_GROUPS@{DSKT2\_\-NUM\_\-SCRATCH\_\-GROUPS}}
\index{DSKT2_NUM_SCRATCH_GROUPS@{DSKT2\_\-NUM\_\-SCRATCH\_\-GROUPS}!DSPDSKT2@{DSPDSKT2}}
\paragraph[DSKT2\_\-NUM\_\-SCRATCH\_\-GROUPS]{\setlength{\rightskip}{0pt plus 5cm}\#define DSKT2\_\-NUM\_\-SCRATCH\_\-GROUPS~20}\hfill}
\label{group___d_s_p_d_s_k_t2_g6ea3f0bc0c9a697930cf7d8411975ac2}


Maximum number of scratch groups that can be supported. 

Definition at line 38 of file dskt2.h.\hypertarget{group___d_s_p_d_s_k_t2_gb7906673f1c60a08206bd37c7f7d1178}{
\index{DSPDSKT2@{DSPDSKT2}!DSKT2_MAX_MEM_ALLOCATION_SIZE@{DSKT2\_\-MAX\_\-MEM\_\-ALLOCATION\_\-SIZE}}
\index{DSKT2_MAX_MEM_ALLOCATION_SIZE@{DSKT2\_\-MAX\_\-MEM\_\-ALLOCATION\_\-SIZE}!DSPDSKT2@{DSPDSKT2}}
\paragraph[DSKT2\_\-MAX\_\-MEM\_\-ALLOCATION\_\-SIZE]{\setlength{\rightskip}{0pt plus 5cm}\#define DSKT2\_\-MAX\_\-MEM\_\-ALLOCATION\_\-SIZE~0x\-FFFF}\hfill}
\label{group___d_s_p_d_s_k_t2_gb7906673f1c60a08206bd37c7f7d1178}


Maximum memory allocation. 

Definition at line 43 of file dskt2.h.\hypertarget{group___d_s_p_d_s_k_t2_gcb5e98129cb03f61436195c9fd240804}{
\index{DSPDSKT2@{DSPDSKT2}!DSKT2_NUM_SHAREDHEAPS@{DSKT2\_\-NUM\_\-SHAREDHEAPS}}
\index{DSKT2_NUM_SHAREDHEAPS@{DSKT2\_\-NUM\_\-SHAREDHEAPS}!DSPDSKT2@{DSPDSKT2}}
\paragraph[DSKT2\_\-NUM\_\-SHAREDHEAPS]{\setlength{\rightskip}{0pt plus 5cm}\#define DSKT2\_\-NUM\_\-SHAREDHEAPS~2}\hfill}
\label{group___d_s_p_d_s_k_t2_gcb5e98129cb03f61436195c9fd240804}




Definition at line 48 of file dskt2.h.

\subsubsection{Typedef Documentation}
\hypertarget{group___d_s_p_d_s_k_t2_gc2be66a39e491bc30ef6f01d7a0a4361}{
\index{DSPDSKT2@{DSPDSKT2}!DSKT2_CacheWBInvFxn@{DSKT2\_\-CacheWBInvFxn}}
\index{DSKT2_CacheWBInvFxn@{DSKT2\_\-CacheWBInvFxn}!DSPDSKT2@{DSPDSKT2}}
\paragraph[DSKT2\_\-CacheWBInvFxn]{\setlength{\rightskip}{0pt plus 5cm}typedef Void($\ast$) \hyperlink{group___d_s_p_d_s_k_t2_gc2be66a39e491bc30ef6f01d7a0a4361}{DSKT2\_\-Cache\-WBInv\-Fxn}(Ptr block\-Ptr, size\_\-t byte\-Cnt, Bool wait)}\hfill}
\label{group___d_s_p_d_s_k_t2_gc2be66a39e491bc30ef6f01d7a0a4361}


Function prototype of cache writeback function: Writes back the memory within the range of block\-Ptr and block\-Ptr + byte\-Cnt. 

\begin{Desc}
\item[Remarks:]If {\tt wait} is {\tt TRUE}, wait for the writeback to complete before returning from this fuction call. \end{Desc}


Definition at line 57 of file dskt2.h.

\subsubsection{Function Documentation}
\hypertarget{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{
\index{DSPDSKT2@{DSPDSKT2}!DSKT2_activateAlg@{DSKT2\_\-activateAlg}}
\index{DSKT2_activateAlg@{DSKT2\_\-activateAlg}!DSPDSKT2@{DSPDSKT2}}
\paragraph[DSKT2\_\-activateAlg]{\setlength{\rightskip}{0pt plus 5cm}Void DSKT2\_\-activate\-Alg (Int {\em scratch\-Mutex\-Id}, \hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} {\em alg})}\hfill}
\label{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}


Prepares a x\-DAIS algorithm instance object to start using its scratch memory. 

\hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg()} performs all scratch memory initialization for an algorithm's instance object. After a successful return from \hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg()}, the algorithm's instance object is ready to be used to process data.

Unless the instance is already active, \hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg()} uses the algorithm's IALG interface function alg\-Activate to initialize the algorithm instance's scratch buffers from persistent data memory.

\hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg()} must be called before any processing or control methods of the algorithm instance can be called.

DSKT2 maintains state information about current \char`\"{}active\char`\"{} algorithm instances at run-time, so that it does not perform unnecessary IALG \char`\"{}activation\char`\"{} calls when alg is already active. As part of this optimization it may call the alg\-Deactivate method of the currently active algorithm instance in order to activate this algorithm instance (alg).

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[\mbox{$\leftarrow$} {\em scratch\-Mutex\-Id}]scratch-group Id used to associate the instance with a scratch group. The value must be the same id used when creating this algorithm instance.\item[\mbox{$\leftarrow$} {\em alg}]IALG\_\-Handle of the algorithm instance to be activated.\end{description}
\end{Desc}
\begin{Desc}
\item[Return values:]
\begin{description}
\item[{\em None}]\end{description}
\end{Desc}
\begin{Desc}
\item[Precondition:]alg must be a valid handle for the algorithm's instance object returned by an earlier call to \hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg()}

If alg uses DMA (IDMA2) dma\-Init must be called before calling this methed, ensuring that all of the instance's persistent memory is initialized and the object is ready to be used

No other algorithm method is currently being run on this instance. This method never preempts any other method on the same instance.\end{Desc}
\begin{Desc}
\item[Postcondition:]All of the instance's persistent and scratch memory is initialized and the object is ready to be used.\end{Desc}
\begin{Desc}
\item[Remarks:]Caller ensures algorithms with the same \char`\"{}scratch\-Mutex\-Id\char`\"{} will not be activated simultaneously. Usually the scratch group id is associated to the priority of the task in which the algorithm is running.

The implementation of the IALG alg\-Activate() is optional by x\-DAIS standard. So, the instance activation makes sense only when the method is implemented by the algorithm. \hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg()} makes proper checks to ensure correct operation even if the algorithm does not implement the alg\-Activate() method.\end{Desc}
\begin{Desc}
\item[See also:]\hyperlink{group___d_s_p_d_s_k_t2_g74b6b6feca63328906acade37d23b597}{DSKT2\_\-deactivate\-Alg()} 

DMAN\_\-add\-Alg() \end{Desc}
\hypertarget{group___d_s_p_d_s_k_t2_g65d8c7ae9d40adcda0c92a9e51c6fd0b}{
\index{DSPDSKT2@{DSPDSKT2}!DSKT2_controlAlg@{DSKT2\_\-controlAlg}}
\index{DSKT2_controlAlg@{DSKT2\_\-controlAlg}!DSPDSKT2@{DSPDSKT2}}
\paragraph[DSKT2\_\-controlAlg]{\setlength{\rightskip}{0pt plus 5cm}Int DSKT2\_\-control\-Alg (\hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} {\em alg}, \hyperlink{group__ti__xdais___i_a_l_g_g9032f20923ef2ba1d6b88c87a20075fa}{IALG\_\-Cmd} {\em cmd}, \hyperlink{struct_i_a_l_g___status}{IALG\_\-Status} $\ast$ {\em status})}\hfill}
\label{group___d_s_p_d_s_k_t2_g65d8c7ae9d40adcda0c92a9e51c6fd0b}


This is a convenience API to call a x\-DAIS algorithm instance's alg\-Control function. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[\mbox{$\leftarrow$} {\em alg}]IALG\_\-Handle of the algorithm instance. \item[\mbox{$\leftarrow$} {\em cmd}]IALG\_\-Cmd structure for the control operation. \item[\mbox{$\leftarrow$} {\em status}]Pointer to \hyperlink{struct_i_a_l_g___status}{IALG\_\-Status} structure for algorithm to return status.\end{description}
\end{Desc}
\begin{Desc}
\item[Return values:]
\begin{description}
\item[{\em IALG\_\-EOK}]The control operation was successful \item[{\em otherwise}]A failure occurred during the control operation\end{description}
\end{Desc}
\begin{Desc}
\item[Precondition:]alg must be a valid handle for the algorithm's instance object returned by an earlier call to \hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg()}

Algorithm specific cmd values are always less than IALG\_\-SYSCMD\end{Desc}
\begin{Desc}
\item[Postcondition:]If the control operation is successful, the return value from this operation is equal to IALG\_\-EOK; otherwise it is equal to either IALG\_\-EFAIL or an algorithm-specific return value

If the cmd value is not recognized, the return value is not equal to IALG\_\-EOK\end{Desc}
\begin{Desc}
\item[Note:]\hyperlink{group___d_s_p_d_s_k_t2_g65d8c7ae9d40adcda0c92a9e51c6fd0b}{DSKT2\_\-control\-Alg()} must be called only when the instance is in active state

The implementation of the IALG alg\-Control is optional by XDAIS standard. \hyperlink{group___d_s_p_d_s_k_t2_g65d8c7ae9d40adcda0c92a9e51c6fd0b}{DSKT2\_\-control\-Alg()} makes proper checks to ensure correct operation even if the algorithm does not implement alg\-Control. \end{Desc}
\hypertarget{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{
\index{DSPDSKT2@{DSPDSKT2}!DSKT2_createAlg@{DSKT2\_\-createAlg}}
\index{DSKT2_createAlg@{DSKT2\_\-createAlg}!DSPDSKT2@{DSPDSKT2}}
\paragraph[DSKT2\_\-createAlg]{\setlength{\rightskip}{0pt plus 5cm}\hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} DSKT2\_\-create\-Alg (Int {\em scratch\-Mutex\-Id}, \hyperlink{struct_i_a_l_g___fxns}{IALG\_\-Fxns} $\ast$ {\em fxns}, \hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} {\em parent}, \hyperlink{struct_i_a_l_g___params}{IALG\_\-Params} $\ast$ {\em params})}\hfill}
\label{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}


Creates and initializes a x\-DAIS algorithm instance object. 

It uses the algorithm's IALG interface functions to query the algorithm for its memory needs then allocates the memory for the algorithm and calls the algorithm's alg\-Init function to let the new algorithm instance object initialize itself using the allocated memory.

\hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg()} performs initialization necessary to complete the run-time creation of an algorithm's instance object. After a successful return from \hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg()}, the algorithm's instance object can be activated via a \hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg()} before it can be used to process data.

\hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg()} tries to dynamically allocate instance memory based on the IALG\_\-Mem\-Space attribute of the requested memory. Global DSKT2 configuration settings allow OEM to designate a memory heap for each IALG\_\-Mem\-Space. \hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg()} attempts to allocate memory in the requested space, but may search for alternative heaps when preferred heap is not large enough.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[\mbox{$\leftarrow$} {\em scratch\-Mutex\-Id}]Scratch-group Id for determining the shared scratch memory buffer. Value -1 is used to disable scratch sharing for this algorithm instance. A value between 0 and (DSKT2\_\-NUM\_\-SCRATCH\_\-GROUPS-1) indicates a valid scratch group \item[\mbox{$\leftarrow$} {\em fxns}]Pointer to the algorithm's \hyperlink{struct_i_a_l_g___fxns}{IALG\_\-Fxns} table. \item[\mbox{$\leftarrow$} {\em parent}]Handle of parent algorithm (optional). \item[\mbox{$\leftarrow$} {\em params}]Pointer to an \hyperlink{struct_i_a_l_g___params}{IALG\_\-Params} structure.\end{description}
\end{Desc}
\begin{Desc}
\item[Return values:]
\begin{description}
\item[{\em non-NULL}]IALG\_\-Handle for the new instance object. \item[{\em NULL}]Failure.\end{description}
\end{Desc}
\begin{Desc}
\item[Precondition:]fxns is a valid pointer to an \hyperlink{struct_i_a_l_g___fxns}{IALG\_\-Fxns} structure (containing the vtable for a XDAIS compliant algorithm)\end{Desc}
\begin{Desc}
\item[Postcondition:]If scratch\-Mutex\-Id is -1, all instance scratch memory is allocated as persistent (i.e. not shared) and instance operation does not require mutual exclusion

With the exception of any initialization performed by alg\-Activate and (IDMA2) dma\-Init all of the instance's persistent memory is initialized and the object is ready to be used\end{Desc}
\begin{Desc}
\item[Note:]The parent argument is a handle to another algorithm instance object. This parameter is often NULL, indicating that no parent object exists. This parameter allows clients to create a shared algorithm instance object and pass it to other algorithm instances. For example, a parent instance object might contain global read-only tables that are used by several instances of a vocoder.\end{Desc}
\begin{Desc}
\item[Remarks:]Caller need to ensure algorithms created with the same \char`\"{}scratch\-Mutex\-Id\char`\"{} will not execute simultaneously

On failure all memory allocated during the call (used for algorithm query, and portions of algorithm memory that were successfully allocated during the function) has been freed before \hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg()} returns\end{Desc}
\begin{Desc}
\item[Note:]The params argument is a pointer to algorithm-specific parameters that are necessary for the creation and initialization of the instance object. This pointer points to the same parameters passed to the algorithm's IALG alg\-Alloc function. However, this pointer may be NULL. In this case, algorithm's IALG function alg\-Init, must assume default creation parameters.\end{Desc}
\begin{Desc}
\item[See also:]\hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg()}, \hyperlink{group___d_s_p_d_s_k_t2_g74b6b6feca63328906acade37d23b597}{DSKT2\_\-deactivate\-Alg()}, \hyperlink{group___d_s_p_d_s_k_t2_g8dffa02b3ca1ff6856ce3cf610be7435}{DSKT2\_\-free\-Alg()} \end{Desc}
\hypertarget{group___d_s_p_d_s_k_t2_gda6c7f86ed679447cb8f69b0c50a616c}{
\index{DSPDSKT2@{DSPDSKT2}!DSKT2_createAlg2@{DSKT2\_\-createAlg2}}
\index{DSKT2_createAlg2@{DSKT2\_\-createAlg2}!DSPDSKT2@{DSPDSKT2}}
\paragraph[DSKT2\_\-createAlg2]{\setlength{\rightskip}{0pt plus 5cm}\hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} DSKT2\_\-create\-Alg2 (Int {\em scratch\-Mutex\-Id}, \hyperlink{struct_i_a_l_g___fxns}{IALG\_\-Fxns} $\ast$ {\em fxns}, \hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} {\em parent}, \hyperlink{struct_i_a_l_g___params}{IALG\_\-Params} $\ast$ {\em params}, Int {\em ext\-Heap\-Id})}\hfill}
\label{group___d_s_p_d_s_k_t2_gda6c7f86ed679447cb8f69b0c50a616c}


Creates and initializes a x\-DAIS algorithm instance object. 

It uses the algorithm's IALG interface functions to query the algorithm for its memory needs then allocates the memory for the algorithm and calls the algorithm's alg\-Init function to let the new algorithm instance object initialize itself using the allocated memory.

\hyperlink{group___d_s_p_d_s_k_t2_gda6c7f86ed679447cb8f69b0c50a616c}{DSKT2\_\-create\-Alg2()} performs initialization necessary to complete the run-time creation of an algorithm's instance object. After a successful return from \hyperlink{group___d_s_p_d_s_k_t2_gda6c7f86ed679447cb8f69b0c50a616c}{DSKT2\_\-create\-Alg2()}, the algorithm's instance object can be activated via a \hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg()} before it can be used to process data.

\hyperlink{group___d_s_p_d_s_k_t2_gda6c7f86ed679447cb8f69b0c50a616c}{DSKT2\_\-create\-Alg2()} tries to dynamically allocate instance memory based on the IALG\_\-Mem\-Space attribute of the requested memory. Global DSKT2 configuration settings allow OEM to designate a memory heap for each IALG\_\-Mem\-Space. \hyperlink{group___d_s_p_d_s_k_t2_gda6c7f86ed679447cb8f69b0c50a616c}{DSKT2\_\-create\-Alg2()} attempts to allocate memory in the requested space, but may search for alternative heaps when preferred heap is not large enough.

\hyperlink{group___d_s_p_d_s_k_t2_gda6c7f86ed679447cb8f69b0c50a616c}{DSKT2\_\-create\-Alg2()} will attempt to use the heap specified by the input parameter, ext\-Heap\-Id, for all allocations in the IALG\_\-Mem\-Space, IALG\_\-ESDATA. Furthermore, this holds for any IALG\_\-Mem\-Space that has been configured with the same memory segment as IALG\_\-ESDATA. e.g., if IALG\_\-ESDATA and IALG\_\-SARAM3 have both been configured to use the heap in the memory segment EXTMEM, then \hyperlink{group___d_s_p_d_s_k_t2_gda6c7f86ed679447cb8f69b0c50a616c}{DSKT2\_\-create\-Alg2()} will attempt to allocate memory requested in the spaces IALG\_\-SARAM3 and IALG\_\-ESDATA, from the heap, ext\-Heap\-Id.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[\mbox{$\leftarrow$} {\em scratch\-Mutex\-Id}]Scratch-group Id for determining the shared scratch memory buffer. Value -1 is used to disable scratch sharing for this algorithm instance. A value between 0 and (DSKT2\_\-NUM\_\-SCRATCH\_\-GROUPS-1) indicates a valid scratch group \item[\mbox{$\leftarrow$} {\em fxns}]Pointer to the algorithm's \hyperlink{struct_i_a_l_g___fxns}{IALG\_\-Fxns} table. \item[\mbox{$\leftarrow$} {\em parent}]Handle of parent algorithm (optional). \item[\mbox{$\leftarrow$} {\em params}]Pointer to an \hyperlink{struct_i_a_l_g___params}{IALG\_\-Params} structure. \item[\mbox{$\leftarrow$} {\em ext\-Heap\-Id}]Segment Id of memory heap to be used for all allocations in memory space IALG\_\-ESDATA. This segment will be used instead of the default external memory segment.\end{description}
\end{Desc}
\begin{Desc}
\item[Return values:]
\begin{description}
\item[{\em non-NULL}]IALG\_\-Handle for the new instance object. \item[{\em NULL}]Failure.\end{description}
\end{Desc}
\begin{Desc}
\item[Precondition:]fxns is a valid pointer to an \hyperlink{struct_i_a_l_g___fxns}{IALG\_\-Fxns} structure (containing the vtable for a XDAIS compliant algorithm)

ext\-Heap\-Id $>$= 0\end{Desc}
\begin{Desc}
\item[Postcondition:]If scratch\-Mutex\-Id is -1, all instance scratch memory is allocated as persistent (i.e. not shared) and instance operation does not require mutual exclusion

With the exception of any initialization performed by alg\-Activate and (IDMA2) dma\-Init all of the instance's persistent memory is initialized and the object is ready to be used\end{Desc}
\begin{Desc}
\item[Note:]The parent argument is a handle to another algorithm instance object. This parameter is often NULL, indicating that no parent object exists. This parameter allows clients to create a shared algorithm instance object and pass it to other algorithm instances. For example, a parent instance object might contain global read-only tables that are used by several instances of a vocoder.\end{Desc}
\begin{Desc}
\item[Remarks:]Caller need to ensure algorithms created with the same \char`\"{}scratch\-Mutex\-Id\char`\"{} will not execute simultaneously

On failure all memory allocated during the call (used for algorithm query, and portions of algorithm memory that were successfully allocated during the function) has been freed before \hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg()} returns\end{Desc}
\begin{Desc}
\item[Note:]The params argument is a pointer to algorithm-specific parameters that are necessary for the creation and initialization of the instance object. This pointer points to the same parameters passed to the algorithm's IALG alg\-Alloc function. However, this pointer may be NULL. In this case, algorithm's IALG function alg\-Init, must assume default creation parameters.\end{Desc}
\begin{Desc}
\item[See also:]\hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg()}, \hyperlink{group___d_s_p_d_s_k_t2_g74b6b6feca63328906acade37d23b597}{DSKT2\_\-deactivate\-Alg()}, \hyperlink{group___d_s_p_d_s_k_t2_g8dffa02b3ca1ff6856ce3cf610be7435}{DSKT2\_\-free\-Alg()} \end{Desc}
\hypertarget{group___d_s_p_d_s_k_t2_g74b6b6feca63328906acade37d23b597}{
\index{DSPDSKT2@{DSPDSKT2}!DSKT2_deactivateAlg@{DSKT2\_\-deactivateAlg}}
\index{DSKT2_deactivateAlg@{DSKT2\_\-deactivateAlg}!DSPDSKT2@{DSPDSKT2}}
\paragraph[DSKT2\_\-deactivateAlg]{\setlength{\rightskip}{0pt plus 5cm}Void DSKT2\_\-deactivate\-Alg (Int {\em scratch\-Mutex\-Id}, \hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} {\em alg})}\hfill}
\label{group___d_s_p_d_s_k_t2_g74b6b6feca63328906acade37d23b597}


Prepares a x\-DAIS algorithm instance object to give up using its scratch memory. 

\hyperlink{group___d_s_p_d_s_k_t2_g74b6b6feca63328906acade37d23b597}{DSKT2\_\-deactivate\-Alg()} marks an algorithm's shared scratch memory as available to other instances activation. After a successful return from \hyperlink{group___d_s_p_d_s_k_t2_g74b6b6feca63328906acade37d23b597}{DSKT2\_\-deactivate\-Alg()}, the algorithm's processing or control functions cannot be called to process data.

Object's deactivation logic involves calling the algorithm's IALG interface function alg\-Deactivate to save necessary data from the algorithm instance's scratch buffers to its persistent data memory.

\hyperlink{group___d_s_p_d_s_k_t2_g74b6b6feca63328906acade37d23b597}{DSKT2\_\-deactivate\-Alg()} must be called after the last processing or control methods of the algorithm instance, alg, during each execute stage of its socket operation.

DSKT2 maintains state information about current \char`\"{}active\char`\"{} algorithm instances at run-time, so that it does not perform unnecessary IALG \char`\"{}deactivation\char`\"{} calls. As part of this optimization it may defer the deactivation of this algorithm instance (alg) to a later stage, i.e. when \hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg()} is called to activate another algorithm instance.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[\mbox{$\leftarrow$} {\em scratch\-Mutex\-Id}]scratch-group Id used for determining the shared scratch memory. \item[\mbox{$\leftarrow$} {\em alg}]IALG\_\-Handle of the algorithm instance to be deactivated.\end{description}
\end{Desc}
\begin{Desc}
\item[Return values:]
\begin{description}
\item[{\em None}]\end{description}
\end{Desc}
\begin{Desc}
\item[Precondition:]alg must be a valid handle for the algorithm's instance object returned by an earlier call to \hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg()}

No other algorithm method is currently being run on this instance. This method never preempts any other method on the same instance.

\hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg()} must be called before calling this method\end{Desc}
\begin{Desc}
\item[Note:]The implementation of the IALG alg\-Deactivate is optional by XDAIS standard. So, the instance deactivation makes sense only when the method is implemented by the algorithm. \hyperlink{group___d_s_p_d_s_k_t2_g74b6b6feca63328906acade37d23b597}{DSKT2\_\-deactivate\-Alg()} makes proper checks to ensure correct operation even if the algorithm does not implement the alg\-Deactivate methods.\end{Desc}
\begin{Desc}
\item[See also:]\hyperlink{group___d_s_p_d_s_k_t2_gf946d426d6d9a95040d3967fa746cd7a}{DSKT2\_\-activate\-Alg()} \end{Desc}
\hypertarget{group___d_s_p_d_s_k_t2_g2d252c736a3bb828d9f646cc379ac0e2}{
\index{DSPDSKT2@{DSPDSKT2}!DSKT2_deactivateAll@{DSKT2\_\-deactivateAll}}
\index{DSKT2_deactivateAll@{DSKT2\_\-deactivateAll}!DSPDSKT2@{DSPDSKT2}}
\paragraph[DSKT2\_\-deactivateAll]{\setlength{\rightskip}{0pt plus 5cm}Int DSKT2\_\-deactivate\-All ()}\hfill}
\label{group___d_s_p_d_s_k_t2_g2d252c736a3bb828d9f646cc379ac0e2}


All algorithms that have been deactivated lazily are now really deactivate. Any algorithms that are still currently active will be left as is. The number of algorithms that are still active will be returned from this call. 

\begin{Desc}
\item[Return values:]
\begin{description}
\item[{\em $>$=0}]The number of currently active algorithms\end{description}
\end{Desc}
\begin{Desc}
\item[Precondition:]Must be called with the TSK and SWI schedulers disabled. \end{Desc}
\hypertarget{group___d_s_p_d_s_k_t2_g8dffa02b3ca1ff6856ce3cf610be7435}{
\index{DSPDSKT2@{DSPDSKT2}!DSKT2_freeAlg@{DSKT2\_\-freeAlg}}
\index{DSKT2_freeAlg@{DSKT2\_\-freeAlg}!DSPDSKT2@{DSPDSKT2}}
\paragraph[DSKT2\_\-freeAlg]{\setlength{\rightskip}{0pt plus 5cm}Bool DSKT2\_\-free\-Alg (Int {\em scratch\-Mutex\-Id}, \hyperlink{struct_i_a_l_g___obj}{IALG\_\-Handle} {\em alg})}\hfill}
\label{group___d_s_p_d_s_k_t2_g8dffa02b3ca1ff6856ce3cf610be7435}


Deletes a x\-DAIS algorithm instance object and frees all persistent memory allocated for the instance object. 

A reference counting mechanism is implemented to free up instance scratch memory so that when the last instance within a scratch group is deleted all shared scratch memory allocated for the group is reclaimed.

\hyperlink{group___d_s_p_d_s_k_t2_g8dffa02b3ca1ff6856ce3cf610be7435}{DSKT2\_\-free\-Alg()} must be called during delete stage of a socket's operation to prevent memory leaks.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[\mbox{$\leftarrow$} {\em scratch\-Mutex\-Id}]scratch-group Id used for determining the shared scratch memory. Must be the same Id used when algorithm instance is created \item[\mbox{$\leftarrow$} {\em alg}]IALG\_\-Handle of the algorithm instance to be deleted\end{description}
\end{Desc}
\begin{Desc}
\item[Return values:]
\begin{description}
\item[{\em TRUE}]Success \item[{\em FALSE}]Failure\end{description}
\end{Desc}
\begin{Desc}
\item[Precondition:]alg must be a valid handle for the algorithm's instance object returned by an earlier call to \hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg()}\end{Desc}
\begin{Desc}
\item[Note:]DSKT2 maintains allocation information about all algorithm instances created by \hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg()}, so it does not call the instance alg\-Free method before free'ing instance memory.\end{Desc}
\begin{Desc}
\item[See also:]\hyperlink{group___d_s_p_d_s_k_t2_g5528d73c34724bc310404da0dc2fbd69}{DSKT2\_\-create\-Alg()} \end{Desc}
